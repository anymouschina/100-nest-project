# åå»ºä¿®ç¼®é˜²æ°´æœåŠ¡åº”ç”¨ - æ¥å£æ¢³ç†æŠ¥å‘Š

## é¡¹ç›®æ¦‚è§ˆ

- **é¡¹ç›®åç§°:** åå»ºä¿®ç¼®é˜²æ°´ä¿®ç¼®æœåŠ¡åº”ç”¨
- **æŠ€æœ¯æ ˆ:** UniApp + Vue3 + TypeScript + wot-design-uni + Pinia
- **ä¸šåŠ¡é¢†åŸŸ:** é˜²æ°´æœåŠ¡é¢„çº¦å¹³å°
- **æ ¸å¿ƒåŠŸèƒ½:** é˜²æ°´è¡¥æ¼ã€æ–°æˆ¿é˜²æ°´æ–½å·¥ã€ç–é€šç®¡é“æœåŠ¡é¢„çº¦

## å½“å‰çŠ¶æ€åˆ†æ

### âœ… å·²å®Œæˆçš„æ¥å£

1. **ç”¨æˆ·è®¤è¯æ¨¡å—** (`src/api/login.ts`)
   - è·å–éªŒè¯ç : `GET /user/getCode`
   - ç”¨æˆ·ç™»å½•: `POST /user/login`
   - è·å–ç”¨æˆ·ä¿¡æ¯: `GET /user/info`
   - é€€å‡ºç™»å½•: `POST /user/logout`
   - ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯: `POST /user/updateInfo`
   - ä¿®æ”¹å¯†ç : `POST /user/updatePassword`
   - å¾®ä¿¡ç™»å½•: `POST /user/wxLogin`

### ğŸ”„ éœ€è¦æ”¹æˆæ¥å£è°ƒç”¨çš„åœ°æ–¹

## 1. é¦–é¡µæ¨¡å— (`src/pages/index/index.vue`)

### å½“å‰é—®é¢˜

- è½®æ’­å›¾æ•°æ®å†™æ­»åœ¨ä»£ç ä¸­
- æœåŠ¡å¡ç‰‡æ•°æ®ç¡¬ç¼–ç 
- ç»Ÿè®¡æ•°æ®å›ºå®šå€¼

### éœ€è¦çš„æ¥å£

```typescript
// è·å–é¦–é¡µè½®æ’­å›¾
GET / api / home / banners
Response: {
  data: Array<{
    id: string
    title: string
    summary: string
    imageUrl: string
    linkType: 'service' | 'external' | 'none'
    linkValue: string
    sort: number
    status: 'active' | 'inactive'
  }>
}

// è·å–é¦–é¡µæœåŠ¡åˆ—è¡¨
GET / api / home / services
Response: {
  data: Array<{
    id: string
    name: string
    description: string
    icon: string
    color: string
    features: Array<{
      text: string
      icon: string
    }>
    isHot: boolean
    isRecommended: boolean
  }>
}

// è·å–é¦–é¡µç»Ÿè®¡æ•°æ®
GET / api / home / statistics
Response: {
  data: {
    totalCustomers: number
    satisfactionRate: number
    responseTime: string
    totalOrders: number
  }
}
```

## 2. æœåŠ¡è¯¦æƒ…æ¨¡å— (`src/pages/index/service-detail.vue`)

### å½“å‰é—®é¢˜

- ä½¿ç”¨Mockæ•°æ®ï¼Œæœ‰åˆ‡æ¢å¼€å…³ä½†çœŸå®æ¥å£æœªå®ç°
- æœåŠ¡è¯¦æƒ…æ•°æ®ç¡¬ç¼–ç 

### éœ€è¦çš„æ¥å£

```typescript
// è·å–æœåŠ¡è¯¦æƒ…
GET / api / services / { serviceId }
Response: {
  data: {
    id: string
    title: string
    subtitle: string
    description: string
    bannerImages: Array<{
      url: string
      color: string
    }>
    features: Array<{
      text: string
      icon: string
      color: string
    }>
    problemScenes: Array<{
      name: string
      icon: string
      color: string
    }>
    materials: Array<{
      name: string
      color: string
      description: string
      tags: string[]
    }>
    pricing: {
      basePrice: number
      priceUnit: string
      priceDescription: string
    }
  }
}
```

## 3. é¢„çº¦æ¨¡å— (`src/pages/appointment/index.vue`)

### å½“å‰é—®é¢˜

- è¡¨å•æäº¤åªæœ‰å‰ç«¯éªŒè¯ï¼Œæ— åç«¯æ¥å£
- æœåŠ¡ç±»å‹å’Œåœºæ™¯é€‰é¡¹ç¡¬ç¼–ç 
- æäº¤ååªæ˜¾ç¤ºæˆåŠŸæç¤ºï¼Œæ— çœŸå®æ•°æ®ä¿å­˜

### éœ€è¦çš„æ¥å£

```typescript
// è·å–æœåŠ¡ç±»å‹é€‰é¡¹
GET /api/appointment/service-types
Response: {
  data: Array<{
    value: string
    label: string
    description?: string
    isActive: boolean
  }>
}

// è·å–åœºæ™¯ç±»å‹é€‰é¡¹
GET /api/appointment/scene-types
Response: {
  data: Array<{
    value: string
    label: string
    serviceTypes: string[] // é€‚ç”¨çš„æœåŠ¡ç±»å‹
    isActive: boolean
  }>
}

// æäº¤é¢„çº¦ç”³è¯·
POST /api/appointment/submit
Request: {
  serviceType: string
  sceneType: string
  name: string
  phone: string
  region: string
  location: string
  address: string
  description?: string
  appointmentTime?: string
}
Response: {
  data: {
    appointmentId: string
    orderNo: string
    status: 'pending' | 'confirmed' | 'rejected'
    estimatedContactTime: string
  }
}

// è·å–çœå¸‚åŒºæ•°æ®
GET /api/common/regions
Response: {
  data: Array<{
    code: string
    name: string
    level: number
    parentCode?: string
    children?: Array<Region>
  }>
}
```

## 4. è®¢å•æ¨¡å— (`src/pages/orders/`)

### å½“å‰é—®é¢˜

- è®¢å•åˆ—è¡¨ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
- è®¢å•è¯¦æƒ…æ•°æ®ç¡¬ç¼–ç 
- è®¢å•çŠ¶æ€æ“ä½œæ— çœŸå®æ¥å£

### éœ€è¦çš„æ¥å£

```typescript
// è·å–è®¢å•åˆ—è¡¨
GET /api/orders
Query: {
  status?: 'all' | 'pending' | 'accepted' | 'processing' | 'completed' | 'cancelled'
  page?: number
  pageSize?: number
}
Response: {
  data: {
    list: Array<{
      id: string
      orderNo: string
      serviceType: string
      serviceTypeName: string
      status: string
      statusName: string
      appointmentTime: string
      address: string
      price: number
      createTime: string
      updateTime: string
    }>
    total: number
    page: number
    pageSize: number
  }
}

// è·å–è®¢å•è¯¦æƒ…
GET /api/orders/{orderId}
Response: {
  data: {
    id: string
    orderNo: string
    serviceType: string
    serviceTypeName: string
    status: string
    statusName: string
    appointmentTime: string
    address: string
    price: number
    createTime: string
    contactName: string
    contactPhone: string
    paymentMethod: string
    description: string
    engineer?: {
      name: string
      id: string
      phone: string
      rating: number
      avatar?: string
    }
    statusHistory: Array<{
      status: string
      statusName: string
      time: string
      description?: string
    }>
    serviceDetails?: {
      materials: Array<{
        name: string
        quantity: number
        unit: string
        price: number
      }>
      laborCost: number
      totalCost: number
    }
  }
}

// å–æ¶ˆè®¢å•
POST /api/orders/{orderId}/cancel
Request: {
  reason: string
}
Response: {
  data: {
    success: boolean
    message: string
  }
}

// è®¢å•è¯„ä»·
POST /api/orders/{orderId}/review
Request: {
  rating: number // 1-5æ˜Ÿ
  comment: string
  tags?: string[] // è¯„ä»·æ ‡ç­¾
  images?: string[] // è¯„ä»·å›¾ç‰‡
}
Response: {
  data: {
    reviewId: string
    success: boolean
  }
}
```

## 5. ä¸ªäººä¸­å¿ƒæ¨¡å— (`src/pages/mine/`)

### å½“å‰é—®é¢˜

- ä¸ªäººä¿¡æ¯ä¿®æ”¹æ¥å£å·²æœ‰ä½†å¯èƒ½éœ€è¦æ‰©å±•
- ç¼ºå°‘ç”¨æˆ·å¤´åƒä¸Šä¼ æ¥å£
- ç¼ºå°‘ç”¨æˆ·è®¢å•ç»Ÿè®¡æ¥å£

### éœ€è¦çš„æ¥å£

```typescript
// ä¸Šä¼ å¤´åƒ
POST / api / user / avatar
Request: FormData(file)
Response: {
  data: {
    avatarUrl: string
  }
}

// è·å–ç”¨æˆ·è®¢å•ç»Ÿè®¡
GET / api / user / order - statistics
Response: {
  data: {
    totalOrders: number
    pendingOrders: number
    completedOrders: number
    totalSpent: number
    favoriteService: string
  }
}

// è·å–ç”¨æˆ·æ”¶è—çš„æœåŠ¡
GET / api / user / favorite - services
Response: {
  data: Array<{
    serviceId: string
    serviceName: string
    addTime: string
  }>
}

// æ·»åŠ /å–æ¶ˆæ”¶è—æœåŠ¡
POST / api / user / favorite - services / { serviceId }
Request: {
  action: 'add' | 'remove'
}
```

## 6. é€šç”¨æ¥å£

### éœ€è¦çš„æ¥å£

```typescript
// æ–‡ä»¶ä¸Šä¼ 
POST /api/common/upload
Request: FormData
Response: {
  data: {
    url: string
    filename: string
    size: number
    type: string
  }
}

// è·å–ç³»ç»Ÿé…ç½®
GET /api/common/config
Response: {
  data: {
    customerServicePhone: string
    workingHours: string
    emergencyPhone: string
    companyInfo: {
      name: string
      address: string
      license: string
    }
    appConfig: {
      version: string
      updateUrl?: string
      announcement?: string
    }
  }
}

// æ„è§åé¦ˆ
POST /api/common/feedback
Request: {
  type: 'bug' | 'suggestion' | 'complaint' | 'other'
  content: string
  contact?: string
  images?: string[]
}
Response: {
  data: {
    feedbackId: string
    success: boolean
  }
}
```

## å®æ–½å»ºè®®

### ä¼˜å…ˆçº§æ’åº

#### é«˜ä¼˜å…ˆçº§ (æ ¸å¿ƒä¸šåŠ¡æµç¨‹)

1. **é¢„çº¦æäº¤æ¥å£** - æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½
2. **è®¢å•åˆ—è¡¨å’Œè¯¦æƒ…æ¥å£** - ç”¨æˆ·æŸ¥çœ‹è®¢å•çŠ¶æ€
3. **é¦–é¡µæ•°æ®æ¥å£** - ç”¨æˆ·å…¥å£ä½“éªŒ

#### ä¸­ä¼˜å…ˆçº§ (ç”¨æˆ·ä½“éªŒ)

4. **æœåŠ¡è¯¦æƒ…æ¥å£** - æ›¿æ¢Mockæ•°æ®
5. **è®¢å•æ“ä½œæ¥å£** - å–æ¶ˆè®¢å•ã€è¯„ä»·ç­‰
6. **ç”¨æˆ·ä¿¡æ¯ç›¸å…³æ¥å£** - å®Œå–„ä¸ªäººä¸­å¿ƒ

#### ä½ä¼˜å…ˆçº§ (è¾…åŠ©åŠŸèƒ½)

7. **æ–‡ä»¶ä¸Šä¼ æ¥å£** - å¤´åƒã€åé¦ˆå›¾ç‰‡ç­‰
8. **ç³»ç»Ÿé…ç½®æ¥å£** - å®¢æœç”µè¯ã€å…¬å¸ä¿¡æ¯ç­‰
9. **ç»Ÿè®¡æ•°æ®æ¥å£** - é¦–é¡µå±•ç¤ºæ•°æ®

### æ•°æ®åº“è®¾è®¡å»ºè®®

#### æ ¸å¿ƒè¡¨ç»“æ„

1. **ç”¨æˆ·è¡¨ (users)** - å·²æœ‰
2. **æœåŠ¡ç±»å‹è¡¨ (service_types)** - é˜²æ°´è¡¥æ¼ã€ç–é€šç®¡é“ç­‰
3. **é¢„çº¦è®¢å•è¡¨ (appointments)** - é¢„çº¦ä¿¡æ¯
4. **è®¢å•è¡¨ (orders)** - è®¢å•è¯¦æƒ…
5. **å·¥ç¨‹å¸ˆè¡¨ (engineers)** - æœåŠ¡äººå‘˜ä¿¡æ¯
6. **è¯„ä»·è¡¨ (reviews)** - è®¢å•è¯„ä»·
7. **ç³»ç»Ÿé…ç½®è¡¨ (system_configs)** - ç³»ç»Ÿå‚æ•°

#### å…³è”å…³ç³»

- ç”¨æˆ· 1:N è®¢å•
- è®¢å• 1:1 é¢„çº¦
- è®¢å• N:1 å·¥ç¨‹å¸ˆ
- è®¢å• 1:N è¯„ä»·

### æ¥å£å¼€å‘æ³¨æ„äº‹é¡¹

1. **ç»Ÿä¸€å“åº”æ ¼å¼**

   ```typescript
   interface ApiResponse<T> {
     code: number
     message: string
     data: T
     timestamp: number
   }
   ```

2. **é”™è¯¯å¤„ç†**

   - ç»Ÿä¸€é”™è¯¯ç å®šä¹‰
   - å‹å¥½çš„é”™è¯¯æç¤ºä¿¡æ¯
   - å‰ç«¯é”™è¯¯å¤„ç†æœºåˆ¶

3. **æ•°æ®éªŒè¯**

   - åç«¯å‚æ•°éªŒè¯
   - å‰ç«¯è¡¨å•éªŒè¯
   - æ•°æ®æ ¼å¼ç»Ÿä¸€

4. **å®‰å…¨è€ƒè™‘**

   - æ¥å£é‰´æƒ
   - æ•°æ®è„±æ•
   - é˜²é‡å¤æäº¤

5. **æ€§èƒ½ä¼˜åŒ–**
   - åˆ†é¡µæŸ¥è¯¢
   - æ•°æ®ç¼“å­˜
   - å›¾ç‰‡å‹ç¼©

## æ€»ç»“

å½“å‰é¡¹ç›®ä¸»è¦ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®å’Œç¡¬ç¼–ç æ•°æ®ï¼Œéœ€è¦å¼€å‘çº¦ **25ä¸ªæ ¸å¿ƒæ¥å£** æ¥æ”¯æ’‘å®Œæ•´çš„ä¸šåŠ¡æµç¨‹ã€‚å»ºè®®æŒ‰ç…§ä¼˜å…ˆçº§åˆ†é˜¶æ®µå®æ–½ï¼Œå…ˆå®Œæˆæ ¸å¿ƒä¸šåŠ¡æ¥å£ï¼Œå†é€æ­¥å®Œå–„è¾…åŠ©åŠŸèƒ½æ¥å£ã€‚
